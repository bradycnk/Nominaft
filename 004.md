
-- 1. Añadir columna de relación en la tabla empleados
ALTER TABLE empleados 
ADD COLUMN IF NOT EXISTS sucursal_id UUID REFERENCES sucursales(id) ON DELETE SET NULL;

-- 2. Crear un índice para optimizar las consultas por sucursal
CREATE INDEX IF NOT EXISTS idx_empleados_sucursal ON empleados(sucursal_id);

-- 3. Actualizar la política de RLS para permitir la lectura de la relación
-- (Las políticas existentes de 'Admin full access' ya deberían cubrir esto, 
-- pero nos aseguramos de que el join sea permitido)
